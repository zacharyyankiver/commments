'use strict';

var s = require('react');
var dateFns = require('date-fns');
var emotion = require('emotion');
var n = require('@contentful/f36-tokens');
var reactDayPicker = require('react-day-picker');
var f36Popover = require('@contentful/f36-popover');
var ie = require('react-focus-lock');
var f36Forms = require('@contentful/f36-forms');
var f36Button = require('@contentful/f36-button');
var f36Icons = require('@contentful/f36-icons');

function _interopDefault (e) { return e && e.__esModule ? e : { default: e }; }

var s__default = /*#__PURE__*/_interopDefault(s);
var n__default = /*#__PURE__*/_interopDefault(n);
var ie__default = /*#__PURE__*/_interopDefault(ie);

var X=Object.defineProperty,q=Object.defineProperties;var J=Object.getOwnPropertyDescriptors;var b=Object.getOwnPropertySymbols;var z=Object.prototype.hasOwnProperty,M=Object.prototype.propertyIsEnumerable;var L=(t,o,r)=>o in t?X(t,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[o]=r,m=(t,o)=>{for(var r in o||(o={}))z.call(o,r)&&L(t,r,o[r]);if(b)for(var r of b(o))M.call(o,r)&&L(t,r,o[r]);return t},v=(t,o)=>q(t,J(o));var I=(t,o)=>{var r={};for(var a in t)z.call(t,a)&&o.indexOf(a)<0&&(r[a]=t[a]);if(t!=null&&b)for(var a of b(t))o.indexOf(a)<0&&M.call(t,a)&&(r[a]=t[a]);return r};var W=()=>({calendar:emotion.css({padding:n__default.default.spacingM})});var A=40,E=()=>({vhidden:emotion.css({boxSizing:"border-box",padding:"0",margin:"0",background:"transparent",border:"0",MozAppearance:"none",WebkitAppearance:"none",appearance:"none",position:"absolute",top:"0",width:"1px",height:"1px",overflow:"hidden",clip:"rect(1px, 1px, 1px, 1px)"}),button_reset:emotion.css({appearance:"none",position:"relative",margin:0,padding:0,border:"none",outline:"none",background:"none"}),button:emotion.css({borderRadius:"50%",cursor:"pointer",color:n__default.default.gray900,"&.rdp-day_disabled":{color:n__default.default.gray400,pointerEvents:"none"},"&:focus, &:active":{boxShadow:n__default.default.glowPrimary},"&:focus:not(:focus-visible)":{boxShadow:"unset"},"&:hover":{backgroundColor:n__default.default.gray200},"&.rdp-day_selected:not(.rdp-day_disabled)":{backgroundColor:n__default.default.blue600,color:n__default.default.colorWhite,fontWeight:n__default.default.fontWeightDemiBold}}),months:emotion.css({display:"flex"}),month:emotion.css({width:"100%",margin:"0 1em","&:first-child":{marginLeft:0},"&:last-child":{marginRight:0}}),table:emotion.css({width:"100%",margin:0,borderCollapse:"collapse"}),caption:emotion.css({position:"relative",display:"flex",alignItems:"center",justifyContent:"space-between",padding:0,textAlign:"left",".rdp-multiple_months &":{display:"block",textAlign:"center"}}),caption_dropdowns:emotion.css({position:"relative",display:"inline-flex"}),caption_label:emotion.css({position:"relative",zIndex:1,display:"inline-flex",alignItems:"center",margin:"0",padding:`0 ${n__default.default.spacingXs}`,height:"2rem",whiteSpace:"nowrap",fontSize:n__default.default.fontSizeM,fontWeight:n__default.default.fontWeightMedium,borderRadius:n__default.default.borderRadiusMedium,"& + &":{marginLeft:"3px"}}),nav:emotion.css({whiteSpace:"nowrap",".rdp-multiple_months .rdp-caption_start &":{position:"absolute",top:"50%",left:"0",transform:"translateY(-50%)"},".rdp-multiple_months .rdp-caption_end &":{position:"absolute",top:"50%",right:"0",transform:"translateY(-50%)"}}),nav_button:emotion.css({width:"2rem",height:"2rem",display:"inline-flex",alignItems:"center",justifyContent:"center",backgroundColor:"transparent"}),nav_button_previous:emotion.css({marginRight:"3px"}),dropdown_month:emotion.css({position:"relative",display:"inline-flex",alignItems:"center"}),dropdown_year:emotion.css({position:"relative",display:"inline-flex",alignItems:"center"}),dropdown:emotion.css({appearance:"none",position:"absolute",zIndex:2,top:"0",bottom:"0",left:"0",width:"100%",margin:"0",padding:"0",cursor:"pointer",opacity:"0",border:"none",backgroundColor:"transparent",fontFamily:"inherit",fontSize:"inherit",lineHeight:"inherit","&:focus:not([disabled]) + div, &:active:not([disabled]) + div":{boxShadow:n__default.default.glowPrimary},"&:hover:not([disabled]) + div, &:hover:not([disabled]) + div":{backgroundColor:n__default.default.gray200}}),dropdown_icon:emotion.css({marginLeft:"8px"}),head:emotion.css({border:0}),head_row:emotion.css({height:"100%"}),row:emotion.css({height:"100%"}),head_cell:emotion.css({verticalAlign:"middle",fontSize:n__default.default.fontSizeS,fontWeight:n__default.default.fontWeightDemiBold,textAlign:"center",height:"32px",color:n__default.default.gray600}),tbody:emotion.css({border:0}),tfoot:emotion.css({margin:"0.5em"}),cell:emotion.css({padding:"2px",textAlign:"center"}),day:emotion.css({display:"flex",overflow:"hidden",alignItems:"center",justifyContent:"center",width:`${A/16}rem`,height:`${A/16}rem`,borderRadius:"50%",margin:"auto","&.rdp-day_today:not(.rdp-day_outside)":{fontWeight:n__default.default.fontWeightDemiBold},"&.rdp-day_today:not(.rdp-day_outside):not(.rdp-day_selected):not(:hover)":{backgroundColor:n__default.default.blue100}}),nav_icon:emotion.css({width:"0.625rem"})});function F(t){var r;let o=E();return s__default.default.createElement(reactDayPicker.DayPicker,v(m({captionLayout:"dropdown-buttons"},t),{weekStartsOn:(r=t.weekStartsOn)!=null?r:1,classNames:o}))}function pe(t){let o=W(),N=t,{testId:r="cf-ui-datepicker",className:a,style:k,inputProps:l,popoverProps:x,selected:p,onSelect:d,fromDate:c,toDate:u,locale:P,dateFormat:g="dd LLL yyyy",defaultIsOpen:B,placeholder:_}=N,Y=I(N,["testId","className","style","inputProps","popoverProps","selected","onSelect","fromDate","toDate","locale","dateFormat","defaultIsOpen","placeholder"]),f=s.useCallback(i=>!(!dateFns.isValid(i)||c&&dateFns.startOfDay(c).getTime()>i.getTime()||u&&i.getTime()>dateFns.endOfDay(u).getTime()),[c,u]),y=s.useCallback(i=>dateFns.parse(i,g,new Date,{locale:P}),[P,g]),[j,C]=s.useState(B),[h,w]=s.useState(()=>p?dateFns.format(p,g):"");s.useEffect(()=>{if(!p){w("");return}p.getTime()!==y(h).getTime()&&w(dateFns.format(p,g));},[p]);let $=s.useCallback(i=>{w(i.currentTarget.value);let O=y(i.currentTarget.value);f(O)?d(O):d(void 0);},[d,y,f]),G=s.useCallback(i=>{i&&f(i)&&(d(i),C(!1));},[d,f]),U=h&&!f(y(h));return s__default.default.createElement(f36Popover.Popover,m({isOpen:j,onClose:()=>C(!1)},x),s__default.default.createElement(f36Popover.Popover.Trigger,null,s__default.default.createElement(le,{className:a,style:k,testId:r,isDisabled:l==null?void 0:l.isDisabled,onTriggerClick:()=>{C(i=>!i);}},s__default.default.createElement(f36Forms.TextInput,m({placeholder:typeof _=="undefined"?dateFns.format(new Date,g):_,value:h,onChange:$,isInvalid:(l==null?void 0:l.isInvalid)||U,"aria-label":"Enter date",testId:"cf-ui-datepicker-input"},l)))),s__default.default.createElement(f36Popover.Popover.Content,null,s__default.default.createElement(ie__default.default,{focusOptions:{preventScroll:!0},returnFocus:!0},s__default.default.createElement(F,v(m({},Y),{className:o.calendar,mode:"single",selected:p,onSelect:G,initialFocus:!1,defaultMonth:p,fromDate:c,toDate:u,locale:P})))))}var le=s__default.default.forwardRef((t,o)=>{let c=t,{children:r,testId:a,style:k,className:l,onTriggerClick:x,isDisabled:p}=c,d=I(c,["children","testId","style","className","onTriggerClick","isDisabled"]);return s__default.default.createElement(f36Forms.TextInput.Group,{ref:o,className:l,style:k,testId:a},r,s__default.default.createElement(f36Button.IconButton,m({"aria-label":"Use calendar",variant:"secondary",icon:s__default.default.createElement(f36Icons.CalendarIcon,{"aria-label":"calendar"}),onClick:x,isDisabled:p,testId:"cf-ui-datepicker-button"},d)))});

Object.defineProperty(exports, 'Day', {
	enumerable: true,
	get: function () { return reactDayPicker.Day; }
});
Object.defineProperty(exports, 'DayContent', {
	enumerable: true,
	get: function () { return reactDayPicker.DayContent; }
});
Object.defineProperty(exports, 'useDayPicker', {
	enumerable: true,
	get: function () { return reactDayPicker.useDayPicker; }
});
exports.Calendar = F;
exports.Datepicker = pe;
//# sourceMappingURL=out.js.map
//# sourceMappingURL=index.js.map