"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getAppInfo = void 0;
const definition_api_1 = require("./definition-api");
const organization_api_1 = require("./organization-api");
const contentful_management_1 = require("contentful-management");
const get_management_token_1 = require("./get-management-token");
const getAppInfo = async ({ organizationId, definitionId, token, host, }) => {
    const accessToken = token || (await (0, get_management_token_1.getManagementToken)(host));
    const client = (0, contentful_management_1.createClient)({ accessToken, host });
    const organization = organizationId
        ? await (0, organization_api_1.getOrganizationById)(client, organizationId)
        : await (0, organization_api_1.selectOrganization)(client);
    const definition = definitionId
        ? await (0, definition_api_1.getDefinitionById)(client, organization.value, definitionId)
        : await (0, definition_api_1.selectDefinition)(client, organization.value);
    return {
        accessToken,
        organization,
        definition,
    };
};
exports.getAppInfo = getAppInfo;
