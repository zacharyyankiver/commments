'use strict';

var c = require('react');
var reactDom = require('react-dom');
var emotion = require('emotion');
var f36Icons = require('@contentful/f36-icons');
var f36Button = require('@contentful/f36-button');
var f36TextLink = require('@contentful/f36-text-link');
var f36Core = require('@contentful/f36-core');
var f36Typography = require('@contentful/f36-typography');
var a = require('@contentful/f36-tokens');
var wt = require('react-animate-height');

function _interopDefault (e) { return e && e.__esModule ? e : { default: e }; }

var c__default = /*#__PURE__*/_interopDefault(c);
var a__default = /*#__PURE__*/_interopDefault(a);
var wt__default = /*#__PURE__*/_interopDefault(wt);

var ot=Object.defineProperty,it=Object.defineProperties;var et=Object.getOwnPropertyDescriptors;var b=Object.getOwnPropertySymbols;var U=Object.prototype.hasOwnProperty,j=Object.prototype.propertyIsEnumerable;var X=(t,o,i)=>o in t?ot(t,o,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[o]=i,m=(t,o)=>{for(var i in o||(o={}))U.call(o,i)&&X(t,i,o[i]);if(b)for(var i of b(o))j.call(o,i)&&X(t,i,o[i]);return t},f=(t,o)=>it(t,et(o));var I=(t,o)=>{var i={};for(var r in t)U.call(t,r)&&o.indexOf(r)<0&&(i[r]=t[r]);if(t!=null&&b)for(var r of b(t))o.indexOf(r)<0&&j.call(t,r)&&(i[r]=t[r]);return i};function $(t){let o=c.useRef(t),[,i]=c.useState(!1);return [o,s=>{Object.is(o.current,s)||(o.current=s,i(d=>!d));}]}var q={positive:a__default.default.green600,negative:a__default.default.red600,warning:a__default.default.orange400,primary:a__default.default.blue600},at=({variant:t})=>emotion.css({background:a__default.default.colorWhite,borderRadius:a__default.default.borderRadiusMedium,boxShadow:a__default.default.boxShadowHeavy,boxSizing:"border-box",display:"flex",overflow:"hidden",position:"relative",padding:a__default.default.spacingM,width:"100%","&:before":{backgroundColor:q[t],content:'""',height:"100%",left:0,position:"absolute",top:0,width:"2px"}}),st=({variant:t})=>emotion.css({fill:q[t],marginRight:a__default.default.spacingM,alignItems:"flex-start"}),_=({variant:t})=>({wrapper:at({variant:t}),icon:st({variant:t}),notification:emotion.css({fontSize:a__default.default.fontSizeM,lineHeight:a__default.default.lineHeightM,width:"100%"}),title:emotion.css({color:a__default.default.gray800,fontSize:a__default.default.fontSizeL,lineHeight:a__default.default.lineHeightL}),content:emotion.css({color:a__default.default.gray700,wordBreak:"break-word",hyphens:"auto","&:last-child":{marginBottom:0}}),closeButton:emotion.css({marginBottom:`-${a__default.default.spacingXs}`,marginRight:`-${a__default.default.spacingXs}`,marginTop:`-${a__default.default.spacingXs}`})});var xt=(t,o)=>{var x;let e=t,{className:i,children:r,cta:s,withCloseButton:d=!0,closeButtonAriaLabel:B="Dismiss",variant:l="positive",onClose:v,testId:y="cf-ui-notification",title:w}=e,D=I(e,["className","children","cta","withCloseButton","closeButtonAriaLabel","variant","onClose","testId","title"]),u=_({variant:l}),P=w?"medium":"small",E={positive:c__default.default.createElement(f36Icons.CheckCircleIcon,{variant:l,size:P}),warning:c__default.default.createElement(f36Icons.WarningIcon,{variant:l,size:P}),negative:c__default.default.createElement(f36Icons.ErrorCircleIcon,{variant:l,size:P}),primary:c__default.default.createElement(f36Icons.InfoCircleIcon,{variant:l,size:P})};return c__default.default.createElement(f36Core.Flex,f(m({"data-test-id":y,role:"alert","data-intent":{positive:"success",warning:"warning",negative:"error",primary:"info"}[l],"aria-live":l==="positive"?"polite":"assertive",className:emotion.cx(u.wrapper,i)},D),{ref:o}),c__default.default.createElement(f36Core.Box,{className:emotion.cx(u.icon)},E[l]),c__default.default.createElement(f36Core.Box,{className:emotion.cx(u.notification)},w&&c__default.default.createElement(f36Typography.Heading,{as:"h2",className:emotion.cx(u.title),marginBottom:"spacingXs"},w),r&&c__default.default.createElement(f36Typography.Paragraph,{className:u.content,marginBottom:"spacingXs"},r),(s==null?void 0:s.label)&&c__default.default.createElement(f36TextLink.TextLink,f(m({},s==null?void 0:s.textLinkProps),{as:((x=s==null?void 0:s.textLinkProps)==null?void 0:x.as)||"button"}),s.label)),d&&c__default.default.createElement(f36Core.Box,null,c__default.default.createElement(f36Button.Button,{className:emotion.cx(u.closeButton),variant:"transparent",startIcon:c__default.default.createElement(f36Icons.CloseIcon,null),onClick:()=>{v&&v();},testId:"cf-ui-notification-close","aria-label":B})))},T=c__default.default.forwardRef(xt);var vt={isShown:!1},N=class extends c.Component{constructor(){super(...arguments);this.timer=null;this.state={isShown:!1};this.startTimer=()=>{if(this.props.duration){if(this.props.duration===0)return;this.timer=window.setTimeout(()=>{this.handleClose();},this.props.duration);}};this.stopTimer=()=>{this.props.duration!==0&&this.timer&&(clearTimeout(this.timer),this.timer=null);};this.handleClose=()=>{this.stopTimer(),this.setState({isShown:!1});};this.handleMouseEnter=()=>{this.stopTimer();};this.handleMouseLeave=()=>{this.startTimer();};}componentDidMount(){this.startTimer(),this.setState({isShown:!0});}componentDidUpdate(i){i.isShown!==this.props.isShown&&this.setState({isShown:this.props.isShown});}componentWillUnmount(){this.stopTimer();}render(){let d=this.props,s=I(d,["isShown","duration"]);return c__default.default.createElement(wt__default.default,{duration:200,height:this.state.isShown?"auto":0,easing:"ease-in-out",animateOpacity:!0,onHeightAnimationEnd:()=>{this.state.isShown===!1&&this.props.onClose&&this.props.onClose();}},c__default.default.createElement("div",{className:emotion.cx(emotion.css({pointerEvents:"all"})),onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave},c__default.default.createElement(T,f(m({},s),{onClose:this.handleClose}))))}};N.defaultProps=vt;var J=(t,o)=>({manager:emotion.css({left:0,margin:"0 auto",maxWidth:"560px",position:"fixed",pointerEvents:"none",right:0,[t]:o,zIndex:a__default.default.zIndexNotification}),container:emotion.css({display:"flex",flexDirection:"column",margin:"0 auto",maxWidth:"560px",minWidth:"360px","& > div":{marginBottom:t==="top"?0:a__default.default.spacingS,marginTop:t==="top"?a__default.default.spacingS:0}})});var Q=0,yt=()=>(Q+=1,Q),M=({register:t})=>{let[o,i]=$([]),[r,s]=c.useState("bottom"),[d,B]=c.useState(20),[l,v]=c.useState(6e3),y=J(r,d),w=c.useCallback((n,e)=>{if(n==="bottom"||n==="top"){let x=e&&e.offset?e.offset:20;s(n),B(x);}},[]),D=c.useCallback(n=>{i(o.current.map(e=>e.id!==n?e:f(m({},e),{isShown:!1})));},[o,i]),u=c.useCallback(n=>{i(o.current.filter(e=>e.id!==n));},[o,i]),P=c.useCallback(()=>{i(o.current.map(n=>f(m({},n),{isShown:!1})));},[o,i]),E=c.useCallback((n,e)=>{let x=e&&typeof e.duration!="undefined"?e.duration:l,Z=e!=null&&e.variant?e.variant:"positive",R=e&&typeof e.withClose!="undefined"?e.withClose:!0,W=e!=null&&e.id?e.id:yt(),A={id:W,text:n,onClose:()=>u(W),duration:x,withClose:R,isShown:!0,variant:Z,title:e==null?void 0:e.title,cta:e==null?void 0:e.cta},O=o.current.find(tt=>tt.id===A.id);return O||(i(r==="top"?[A,...o.current]:[...o.current,A]),A)},[u,l,o,r,i]);return t("close",D),t("show",E),t("closeAll",P),t("setPlacement",w),t("setDuration",v),c__default.default.createElement("div",{"data-test-id":"cf-notification-container",className:emotion.cx(y.manager)},c__default.default.createElement("div",{className:emotion.cx(y.container)},o.current.map(n=>c__default.default.createElement(N,{variant:n.variant,duration:n.duration,key:n.id,withCloseButton:n.withClose,onClose:n.onClose,isShown:n.isShown,title:n.title,cta:n.cta},n.text))))};M.displayName="NotificationsManager";var Y=!1,p={};function It(t,o){p[t]=o;}function Tt(t){let o=document.createElement("div");document.body.appendChild(o),reactDom.render(c__default.default.createElement(M,{register:It}),o,t);}function h(t){return (...o)=>Y?Promise.resolve(t(...o)):(Y=!0,new Promise(i=>{Tt(()=>{i(t(...o));});}))}var V=t=>(o,i)=>{if(p.show)return p.show(o,f(m({},i||{}),{variant:t}))},Mt={success:h(V("positive")),error:h(V("negative")),warning:h(V("warning")),info:h(V("primary")),close:h(t=>{if(p.close)return p.close(t)}),closeAll:h(()=>{if(p.closeAll)return p.closeAll()}),setPlacement:h((t,o)=>{if(p.setPlacement)return p.setPlacement(t,o)}),setDuration:h(t=>{if(p.setDuration)return p.setDuration(t)})};

exports.Notification = Mt;
exports.NotificationItem = T;
exports.NotificationItemContainer = N;
exports.NotificationsManager = M;
//# sourceMappingURL=out.js.map
//# sourceMappingURL=index.js.map